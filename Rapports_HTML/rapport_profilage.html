<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Rapport de Profilage - Retail Dataset</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #0a0a1a; color: #e0e0e0; }
        .page { max-width: 900px; margin: 0 auto; padding: 40px; }
        
        /* Cover */
        .cover { text-align: center; padding: 80px 20px; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); border-radius: 16px; margin-bottom: 40px; }
        .cover h1 { font-size: 2.5em; color: #e94560; margin-bottom: 10px; }
        .cover h2 { font-size: 1.3em; color: #aaa; font-weight: 300; }
        .cover .meta { margin-top: 30px; color: #888; font-size: 0.9em; }
        
        /* Sections */
        .section { background: #16213e; border-radius: 12px; padding: 30px; margin-bottom: 25px; page-break-inside: avoid; }
        .section h2 { color: #e94560; font-size: 1.4em; margin-bottom: 15px; border-bottom: 2px solid #e94560; padding-bottom: 8px; }
        .section h3 { color: #4fc3f7; font-size: 1.1em; margin: 15px 0 10px; }
        .section p { line-height: 1.7; color: #ccc; margin-bottom: 10px; }
        
        /* KPIs */
        .kpi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0; }
        .kpi { background: #0f3460; padding: 20px; border-radius: 10px; text-align: center; }
        .kpi .value { font-size: 2em; font-weight: 700; color: #e94560; }
        .kpi .label { font-size: 0.85em; color: #888; margin-top: 5px; }
        
        /* Tables */
        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th { background: #0f3460; color: #4fc3f7; padding: 10px; text-align: left; font-weight: 600; }
        td { padding: 10px; border-bottom: 1px solid #2a2a4a; }
        tr:hover { background: #1a2a4e; }
        
        /* Alert boxes */
        .alert { padding: 15px; border-radius: 8px; margin: 15px 0; }
        .alert-danger { background: rgba(244, 67, 54, 0.15); border-left: 4px solid #f44336; }
        .alert-warning { background: rgba(255, 152, 0, 0.15); border-left: 4px solid #ff9800; }
        .alert-success { background: rgba(76, 175, 80, 0.15); border-left: 4px solid #4caf50; }
        
        /* Comparison */
        .compare { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .compare-box { background: #0f3460; padding: 20px; border-radius: 10px; }
        .compare-box h4 { color: #e94560; margin-bottom: 10px; }
        
        /* Footer */
        .footer { text-align: center; color: #555; padding: 30px; font-size: 0.85em; }
        
        @media print {
            body { background: white; color: #333; }
            .section { border: 1px solid #ddd; }
        }
    </style>
</head>
<body>
<div class="page">

    <!-- PAGE 1: COUVERTURE -->
    <div class="cover">
        <h1>Rapport de Profilage des Donnees</h1>
        <h2>Audit Qualite - Dataset Retail Store Sales</h2>
        <div class="meta">
            <p>ICOM - Master 2 BI & Analytics</p>
            <p>Mabrouk HANNACHI</p>
            <p>Date : 11/02/2026</p>
        </div>
    </div>

    <!-- PAGE 2: RESUME EXECUTIF -->
    <div class="section">
        <h2>1. Resume Executif</h2>
        <p>Ce rapport presente les resultats du profilage automatise du dataset <strong>Retail Store Sales</strong>. 
        L'analyse couvre 15,300 enregistrements bruts a travers 11 colonnes, revelant des anomalies significatives 
        necessitant un nettoyage approfondi.</p>
        
        <div class="kpi-grid">
            <div class="kpi">
                <div class="value">15,300</div>
                <div class="label">Lignes Brutes</div>
            </div>
            <div class="kpi">
                <div class="value">13,792</div>
                <div class="label">Lignes Nettoyees</div>
            </div>
            <div class="kpi">
                <div class="value">1,508</div>
                <div class="label">Lignes Supprimees</div>
            </div>
            <div class="kpi">
                <div class="value">9.9%</div>
                <div class="label">Taux Rejet</div>
            </div>
        </div>
        
        <div class="alert alert-warning">
            <strong>Constat principal :</strong> 9.9% des donnees ont ete supprimees ou corrigees. 
            Les principales causes sont les doublons (59 lignes), les valeurs manquantes et les enregistrements invalides.
        </div>
    </div>

    <!-- PAGE 3: COMPLETUDE -->
    <div class="section">
        <h2>2. Analyse de la Completude</h2>
        <p>Identification des valeurs manquantes (NULL) par colonne dans le dataset brut :</p>
        
        <table>
            <thead><tr><th>Colonne</th><th>Nb NULLs</th><th>% NULLs</th><th>Severite</th></tr></thead>
            <tbody><tr><td>Transaction_ID</td><td>0</td><td>0.0%</td><td style="color:#4caf50">Faible</td></tr>
<tr><td>Customer_ID</td><td>0</td><td>0.0%</td><td style="color:#4caf50">Faible</td></tr>
<tr><td>Customer_Name</td><td>0</td><td>0.0%</td><td style="color:#4caf50">Faible</td></tr>
<tr><td>Product_Category</td><td>0</td><td>0.0%</td><td style="color:#4caf50">Faible</td></tr>
<tr><td>Product_Name</td><td>1229</td><td>8.03%</td><td style="color:#f44336">Critique</td></tr>
<tr><td>Unit_Price</td><td>1213</td><td>7.93%</td><td style="color:#f44336">Critique</td></tr>
<tr><td>Quantity</td><td>1225</td><td>8.01%</td><td style="color:#f44336">Critique</td></tr>
<tr><td>Total_Amount</td><td>1263</td><td>8.25%</td><td style="color:#f44336">Critique</td></tr>
<tr><td>Payment_Method</td><td>1213</td><td>7.93%</td><td style="color:#f44336">Critique</td></tr>
<tr><td>City</td><td>0</td><td>0.0%</td><td style="color:#4caf50">Faible</td></tr>
<tr><td>Transaction_Date</td><td>0</td><td>0.0%</td><td style="color:#4caf50">Faible</td></tr>
<tr><td>loaded_at</td><td>0</td><td>0.0%</td><td style="color:#4caf50">Faible</td></tr>
</tbody>
        </table>
        
        <div class="alert alert-danger">
            <strong>Impact metier :</strong> Les valeurs manquantes dans Product_Name et Unit_Price empechent le calcul 
            correct du chiffre d'affaires et faussent les analyses de ventes par produit.
        </div>
    </div>

    <!-- PAGE 4: UNICITE -->
    <div class="section">
        <h2>3. Analyse de l'Unicite</h2>
        
        <div class="kpi-grid">
            <div class="kpi">
                <div class="value">59</div>
                <div class="label">Doublons Exacts</div>
            </div>
            <div class="kpi">
                <div class="value">300</div>
                <div class="label">IDs Dupliques</div>
            </div>
            <div class="kpi">
                <div class="value">15,241</div>
                <div class="label">Lignes Uniques</div>
            </div>
            <div class="kpi">
                <div class="value">0.4%</div>
                <div class="label">Taux Doublons</div>
            </div>
        </div>
        
        <p><strong>Action corrective :</strong> Suppression des doublons exacts et deduplication des Transaction_IDs en conflit. 
        Seule la premiere occurrence est conservee.</p>
    </div>

    <!-- PAGE 5: VALIDITE -->
    <div class="section">
        <h2>4. Analyse de la Validite</h2>
        
        <h3>4.1 Prix Unitaire (Unit_Price)</h3>
        <div class="compare">
            <div class="compare-box">
                <h4>Avant Nettoyage</h4>
                <p>Min: -996.77 | Max: 999.81</p>
                <p>Moyenne: 491.48 | Mediane: 494.44</p>
                <p style="color:#f44336">Prix negatifs: 144 (0.9%)</p>
            </div>
            <div class="compare-box">
                <h4>Apres Nettoyage</h4>
                <p>Min: 10.03 | Max: 999.81</p>
                <p>Moyenne: 501.77 | Mediane: 494.47</p>
                <p style="color:#4caf50">Prix negatifs: 0 (0%)</p>
            </div>
        </div>
        
        <h3>4.2 Quantite (Quantity)</h3>
        <div class="alert alert-warning">
            <strong>152 transactions</strong> avec quantite nulle ou negative detectees dans les donnees brutes. 
            Corrigees par valeur absolue ou suppression.
        </div>
    </div>

    <!-- PAGE 6: METHODES DE PAIEMENT -->
    <div class="section">
        <h2>5. Distribution des Methodes de Paiement</h2>
        
        <div class="compare">
            <div class="compare-box">
                <h4>Avant (Brut)</h4>
                <table>
                    <thead><tr><th>Methode</th><th>Nb</th><th>%</th></tr></thead>
                    <tbody><tr><td>Credit Card</td><td>3623</td><td>23.7%</td></tr>
<tr><td>Debit Card</td><td>3584</td><td>23.4%</td></tr>
<tr><td>Cash</td><td>3475</td><td>22.7%</td></tr>
<tr><td>PayPal</td><td>3405</td><td>22.3%</td></tr>
</tbody>
                </table>
            </div>
            <div class="compare-box">
                <h4>Apres (Nettoye & Traduit)</h4>
                <table>
                    <thead><tr><th>Methode</th><th>Nb</th><th>%</th></tr></thead>
                    <tbody><tr><td>Carte Crédit</td><td>3283</td><td>23.8%</td></tr>
<tr><td>Carte Débit</td><td>3224</td><td>23.4%</td></tr>
<tr><td>Espèces</td><td>3130</td><td>22.7%</td></tr>
<tr><td>PayPal</td><td>3058</td><td>22.2%</td></tr>
<tr><td>Inconnu</td><td>1097</td><td>8.0%</td></tr>
</tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- PAGE 7: PRODUITS -->
    <div class="section">
        <h2>6. Analyse des Produits</h2>
        
        <div class="kpi-grid" style="grid-template-columns: repeat(3, 1fr);">
            <div class="kpi">
                <div class="value">25</div>
                <div class="label">Produits (Brut)</div>
            </div>
            <div class="kpi">
                <div class="value">25</div>
                <div class="label">Produits (Nettoye)</div>
            </div>
            <div class="kpi">
                <div class="value">0</div>
                <div class="label">Supprimes</div>
            </div>
        </div>
        
        <h3>Top 10 Produits (Apres Nettoyage)</h3>
        <table>
            <thead><tr><th>Produit</th><th>Nb Transactions</th><th>%</th></tr></thead>
            <tbody><tr><td>Rouge à Lèvres</td><td>578</td><td>4.2%</td></tr>
<tr><td>Crème</td><td>576</td><td>4.2%</td></tr>
<tr><td>Casque Audio</td><td>574</td><td>4.2%</td></tr>
<tr><td>Lampe</td><td>571</td><td>4.1%</td></tr>
<tr><td>Mascara</td><td>569</td><td>4.1%</td></tr>
<tr><td>Parfum</td><td>568</td><td>4.1%</td></tr>
<tr><td>Canapé</td><td>568</td><td>4.1%</td></tr>
<tr><td>Smartphone</td><td>566</td><td>4.1%</td></tr>
<tr><td>Ordinateur Portable</td><td>566</td><td>4.1%</td></tr>
<tr><td>Vélo</td><td>561</td><td>4.1%</td></tr>
</tbody>
        </table>
    </div>

    <!-- PAGE 8: VILLES -->
    <div class="section">
        <h2>7. Repartition Geographique</h2>
        
        <p>Les donnees couvrent <strong>10 villes</strong> (traduites en francais).</p>
        
        <table>
            <thead><tr><th>Ville</th><th>Nb Transactions</th><th>%</th></tr></thead>
            <tbody><tr><td>Dallas</td><td>1469</td><td>10.7%</td></tr>
<tr><td>Phoenix</td><td>1408</td><td>10.2%</td></tr>
<tr><td>San Diego</td><td>1400</td><td>10.2%</td></tr>
<tr><td>Philadelphia</td><td>1395</td><td>10.1%</td></tr>
<tr><td>Los Angeles</td><td>1382</td><td>10.0%</td></tr>
<tr><td>San Jose</td><td>1381</td><td>10.0%</td></tr>
<tr><td>San Antonio</td><td>1380</td><td>10.0%</td></tr>
<tr><td>Houston</td><td>1335</td><td>9.7%</td></tr>
<tr><td>Chicago</td><td>1322</td><td>9.6%</td></tr>
<tr><td>New York</td><td>1320</td><td>9.6%</td></tr>
</tbody>
        </table>
    </div>

    <!-- PAGE 9: CATEGORIES -->
    <div class="section">
        <h2>8. Analyse des Categories</h2>
        
        <div class="kpi-grid" style="grid-template-columns: repeat(2, 1fr);">
            <div class="kpi">
                <div class="value">5</div>
                <div class="label">Categories (Brut)</div>
            </div>
            <div class="kpi">
                <div class="value">4</div>
                <div class="label">Categories (Nettoye)</div>
            </div>
        </div>
        
        <div class="alert alert-success">
            <strong>Toutes les categories</strong> ont ete traduites en francais et nettoyees des valeurs "Inconnu".
        </div>
    </div>

    <!-- PAGE 10: PLAN DE REDRESSEMENT -->
    <div class="section">
        <h2>9. Plan de Redressement</h2>
        
        <table>
            <thead><tr><th>Anomalie</th><th>Impact</th><th>Action</th><th>Priorite</th></tr></thead>
            <tbody>
                <tr><td>Valeurs manquantes</td><td>Biais dans les analyses</td><td>Imputation (mediane/mode)</td><td style="color:#f44336">Haute</td></tr>
                <tr><td>Doublons</td><td>Surestimation des volumes</td><td>Deduplication stricte</td><td style="color:#f44336">Haute</td></tr>
                <tr><td>Prix negatifs</td><td>CA fausse</td><td>Valeur absolue</td><td style="color:#ff9800">Moyenne</td></tr>
                <tr><td>Incoherence Total</td><td>Marges incorrectes</td><td>Recalcul Prix * Qte</td><td style="color:#ff9800">Moyenne</td></tr>
                <tr><td>Labels anglais</td><td>Lisibilite rapports</td><td>Traduction FR</td><td style="color:#4caf50">Basse</td></tr>
                <tr><td>Produits inconnus</td><td>Analyses incomplet</td><td>Suppression</td><td style="color:#ff9800">Moyenne</td></tr>
            </tbody>
        </table>
    </div>

    <!-- PAGE 10: CONCLUSION -->
    <div class="section">
        <h2>10. Conclusion et Recommandations</h2>
        
        <p>Le profilage a revele un dataset avec des anomalies significatives mais traitables. 
        Apres nettoyage, <strong>9.9% des donnees</strong> ont ete corrigees ou supprimees, 
        resultant en un dataset de <strong>13,792 lignes propres</strong>.</p>
        
        <h3>Recommandations</h3>
        <ul style="padding-left: 20px; line-height: 2;">
            <li>Mettre en place une validation en amont (Great Expectations) pour prevenir les anomalies</li>
            <li>Monitorer le score DQ quotidiennement via le dashboard Superset</li>
            <li>Configurer des alertes automatiques si le score tombe sous 90%</li>
            <li>Documenter les regles metier dans le glossaire pour faciliter la gouvernance</li>
        </ul>
        
        <div class="alert alert-success">
            <strong>Score de Qualite Final : 88.63 / 100</strong> — Les donnees sont maintenant fiables pour l'analyse business.
        </div>
    </div>

    <div class="footer">
        <p>Rapport genere automatiquement — Pipeline Data Quality — ICOM Master 2 BI&A</p>
        <p>11/02/2026</p>
    </div>

</div>
</body>
</html>